"use strict";if(document.addEventListener("sto_com_fs_content_loaded",e=>{"undefined"!=typeof TPP_SNAP&&e.detail&&e.detail.previewId&&TPP_SNAP.setPreviewElement(e.detail.previewId)}),"undefined"!=typeof TPP_SNAP){TPP_SNAP.onRerenderView(()=>location.reload(!0));const e=async e=>{const t=Array.from(e.querySelectorAll("[data-preview-id]")),a=await Promise.all(t.map(e=>TPP_SNAP.getElementStatus(e.dataset.previewId)));return t.map((e,t)=>({$el:e,status:a[t],previewId:e.dataset.previewId})).filter(({status:e})=>"Section"===e.elementType)};TPP_SNAP.registerButton({css:"tpp-icon-arrow-up",getIcon:function({$button:e}){TPP_SNAP.isLegacyCC?e.innerText="⇧":e.classList.add(this.css)},isVisible:({status:e})=>null===e.custom&&"Section"===e.elementType,isEnabled:async({$node:t})=>{const a=await e(t.parentNode),n=a.findIndex(({$el:e})=>e===t);return n>0},execute:async({$node:t,status:a})=>{const n=await e(t.parentNode),s=n.findIndex(({$el:e})=>e===t),i=await TPP_SNAP.execute("script:tpp_move_section",{sectionId:a.id,pos:""+(s-1)});i&&t.parentNode.insertBefore(t,n[s-1].$el)}}),TPP_SNAP.registerButton({css:"tpp-icon-arrow-down",getIcon:function({$button:e}){TPP_SNAP.isLegacyCC?e.innerText="⇩":e.classList.add(this.css)},isVisible:({status:e})=>null===e.custom&&"Section"===e.elementType,isEnabled:async({$node:t})=>{const a=await e(t.parentNode),n=a.findIndex(({$el:e})=>e===t);return n!==a.length-1},execute:async({$node:t,status:a})=>{const n=await e(t.parentNode),s=n.findIndex(({$el:e})=>e===t),i=await TPP_SNAP.execute("script:tpp_move_section",{sectionId:a.id,pos:""+(s+2)});i&&n[s+1].$el.insertAdjacentElement("afterend",t)}}),TPP_SNAP.overrideDefaultButton("move",{isVisible:()=>!1,isEnabled:()=>!1}),TPP_SNAP.overrideDefaultButton("workflows",{afterExecute:async()=>{location.reload(!0)}});const t=["W500xH0","W1000xH0","W1500xH0"];TPP_SNAP.overrideDefaultButton("crop",{execute:async({$node:e,previewId:a})=>{const n=await TPP_SNAP.cropImage(a,t,!1);n&&e.dispatchEvent(new CustomEvent("imageUpdated",{detail:n}))}}),[{name:"detail_page_news",template:"news.news",label:"Add news item"},{name:"detail_page_pressrelease",template:"pressrelease.news",label:"Add press release item"},{name:"detail_page_references",template:"galleries.reference",label:"Add reference item"},{name:"filter_page_brochures",template:"news.brochures",label:"Add brochure item"},{name:"filter_page_films",template:"news.films",label:"Add film item"}].forEach(({name:e,template:t,label:a})=>TPP_SNAP.registerButton({label:a,css:"tpp-icon-create-page",isVisible:({status:t})=>void 0!==e&&t.name===e,isEnabled:()=>!0,execute:async()=>{await TPP_SNAP.createDataset(t,{})}})),TPP_SNAP.onRequestPreviewElement(async e=>{try{const t=await TPP_SNAP.renderElement(e),a=t.formData.pt_sfIdentifier.value;await TPP_SNAP.setPreviewElement(e),null!=a?window.location.href=await TPP_SNAP.previewUrl()+a:location.reload(!0)}catch(e){console.error(e)}})}